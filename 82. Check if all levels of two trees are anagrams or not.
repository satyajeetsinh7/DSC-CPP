class Solution {
  public:
    bool areAnagrams(Node *root1, Node *root2) {
        if(!root1 && !root2) return true;
        if(!root1 || !root2) return false;
        
        queue<Node*> q1, q2;
        q1.push(root1);
        q2.push(root2);
        
        while(!q1.empty() && !q2.empty()) {
            int n1 = q1.size();
            int n2 = q2.size();
            
            if(n1 != n2) return false;
            
            vector<int> v1, v2;
            
            while(n1--) {
                Node* a = q1.front(); q1.pop();
                Node* b = q2.front(); q2.pop();
                
                v1.push_back(a->data);
                v2.push_back(b->data);
                
                if(a->left)  q1.push(a->left);
                if(a->right) q1.push(a->right);
                if(b->left)  q2.push(b->left);
                if(b->right) q2.push(b->right);
            }
            
            sort(v1.begin(), v1.end());
            sort(v2.begin(), v2.end());
            
            if(v1 != v2) return false;
        }
        return true;
    }
};
